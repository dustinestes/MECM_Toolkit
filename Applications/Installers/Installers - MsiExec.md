# MECM Toolkit - Applications - Installers - MsiExec

This is a reference file containing various items related to the specified installer technology. The contents includes:

&nbsp;

## References

The following items are referenced within this document. Familiarize yourself with them before moving on.

| Name                  | Type                        | Description                                                                                                       | Link |
|-----------------------|-----------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| Windows Installer     | Documentation               | Microsoft provided portal for all documentation regarding the Windows Installer                                   | [Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/msi/windows-installer-portal) |

&nbsp;

## Table of Contents

- [MECM Toolkit - Applications - Installers - MsiExec](#mecm-toolkit---applications---installers---msiexec)
  - [References](#references)
  - [Table of Contents](#table-of-contents)
- [Installation](#installation)
  - [Best Practices](#best-practices)
  - [Using Command Line](#using-command-line)
  - [Using PowerShell](#using-powershell)
- [Uninstallation](#uninstallation)
  - [Using Command Line](#using-command-line-1)
  - [Using PowerShell](#using-powershell-1)
- [References](#references-1)
  - [Extensions](#extensions)
  - [Command-Line Options](#command-line-options)
  - [Standard Installer Command-Line Options](#standard-installer-command-line-options)
  - [Error Codes](#error-codes)

&nbsp;

# Installation

## Best Practices

There are a number of best practices to follow when managing MSI application lifecycles.

| Brief | Description|
|-|-|
| Output Logs | Always generate log output. It makes troubleshooting much easier and you can always go back and reference the log anytime you need to. |
| Don't Force Restarts | If a restart is not needed for the application to function properly, then this should be avoided to prevent loss of data to users. |


## Using Command Line

```dos
MsiExec.exe /i "filename.msi" /qn /l*v "C:\[Repo]\Logging\Application\Install\[Manufacturer]_[Product]_[Version]_[Install].log"
```

## Using PowerShell

```powershell
Start-Process -FilePath "MsiExec.exe" -Argumentlist "/i Filename.msi","/qn","/l*v C:\[Repo]\Logging\Application\Install\[Manufacturer]_[Product]_[Version]_[Install].log" -Wait
```

&nbsp;

# Uninstallation

## Using Command Line

```dos
MsiExec.exe /i "filename.msi"  /qn /l*v "C:\[Repo]\Logging\Application\Install\[Manufacturer]_[Product]_[Version]_[Install].log"
```

## Using PowerShell

```powershell
Start-Process -FilePath "MsiExec.exe" -Argumentlist "/i Filename.msi","/qn","/l*v C:\[Repo]\Logging\Application\Install\[Manufacturer]_[Product]_[Version]_[Install].log" -Wait
```

&nbsp;

# References

## Extensions

For more information see the [Microsoft Learn Documentation](https://learn.microsoft.com/en-us/windows/win32/msi/command-line-options)

| Extension | Description                                |
|-----------|--------------------------------------------|
| .msi      | Windows Installer Database.                |
| .msm      | Windows Installer Merge Module.            |
| .msp      | Windows Installer Patch.                   |
| .mst      | Windows Installer Transform.               |
| .idt      | Exported Windows Installer Database Table. |
| .cub      | Validation module.                         |
| .pcp      | Windows Installer Patch Creation File      |

## Command-Line Options

For more information see the [Microsoft Learn Documentation](https://learn.microsoft.com/en-us/windows/win32/msi/command-line-options)

| Option   | Parameters                                                                          | Meaning                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|----------|-------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /I       | Package\|ProductCode                                                                | Installs or configures a product.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| /f       | [p\|o\|e\|d\|c\|a\|u\|m\|s\|v] Package\|ProductCode                                 | Repairs a product. This option ignores any property values entered on the command line. The default argument list for this option is 'omus.' This option shares the same argument list as the REINSTALLMODE property.<br>p - Reinstalls only if file is missing.<br>o - Reinstalls if file is missing or an older version is installed.<br>e - Reinstalls if file is missing or an equal or older version is installed.<br>d - Reinstalls if file is missing or a different version is installed.<br>c - Reinstalls if file is missing or the stored checksum does not match the calculated value. Only repairs files that have msidbFileAttributesChecksum in the Attributes column of the File table.<br>a - Forces all files to be reinstalled.<br>u - Rewrites all required user-specific registry entries.<br>m - Rewrites all required computer-specific registry entries.<br>s - Overwrites all existing shortcuts.<br>v - Runs from source and re-caches the local package. Do not use the v reinstall option for the first installation of an application or feature.                                                                                            |
| /a       | Package                                                                             | Administrative installation option. Installs a product on the network.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| /x       | Package\|ProductCode                                                                | Uninstalls a product.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| /j       | [u\|m]Packageor<br>[u\|m]Package/tTransform List<br>or<br>[u\|m]Package/gLanguageID | Advertises a product. This option ignores any property values entered on the command line.<br>u - Advertises to the current user.<br>m - Advertises to all users of machine.<br>g - Language identifier.<br>t - Applies transform to advertised package.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| /L       | [i\|w\|e\|a\|r\|u\|c\|m\|o\|p\|v\|x\|+\|!\|*] Logfile                               | Writes logging information into a logfile at the specified existing path. The path to the logfile location must already exist. The installer does not create the directory structure for the logfile. Flags indicate which information to log. If no flags are specified, the default is 'iwearmo.'<br>i - Status messages.<br>w - Nonfatal warnings.<br>e - All error messages.<br>a - Start up of actions.<br>r - Action-specific records.<br>u - User requests.<br>c - Initial UI parameters.<br>m - Out-of-memory or fatal exit information.<br>o - Out-of-disk-space messages.<br>p - Terminal properties.<br>v - Verbose output.<br>x - Extra debugging information. Windows Installer 2.0: Not supported. The x option is available with Windows Installer version 3.0.3790.2180 and later.<br><br>+ - Append to existing file.<br>! - Flush each line to the log.<br>"*" - Wildcard, log all information except for the v and x options. To include the v and x options, specify "/l*vx".<br><br>Note:<br>For more information about all the methods that are available for setting the logging mode, see Normal Logging in the Windows Installer Logging section |
| /m       | filename<br>Note:<br>The length of filename must be no more than eight characters.  | Generates an SMS status .mif file. Must be used with either the install (-i), remove (-x), administrative installation (-a), or reinstall (-f) options. The ISMIF32.DLL is installed as part of SMS and must be on the path.<br>The fields of the status mif file are filled with the following information:<br>Manufacturer - Author<br>Product - Revision Number<br>Version - Subject<br>Locale - Template<br>Serial Number - not set<br>Installation - set by ISMIF32.DLL to "DateTime"<br>InstallStatus - "Success" or "Failed"<br>Description - Error messages in the following order: 1) Error messages generated by installer. 2) Resource from Msi.dll if installation could not commence or user exit. 3) System error message file. 4) Formatted message: "Installer error %i", where %i is error returned from Msi.dll.                                                                                                                                                                                                                                                                                                                                        |
| /p       | PatchPackage[;patchPackage2 ]                                                       | Applies a patch. To apply a patch to an installed administrative image you must combine the following options:<br>/p <PatchPackage>[;patchPackage2 ] /a \<Package>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| /q       | n\|b\|r\|f                                                                          | Sets user interface level.<br>q , qn - No UI<br>qb - Basic UI. Use qb! to hide the Cancel button.<br>qr - Reduced UI with no modal dialog box displayed at the end of the installation.<br>qf - Full UI and any authored FatalError, UserExit, or Exit modal dialog boxes at the end.<br>qn+ - No UI except for a modal dialog box displayed at the end.<br>qb+ - Basic UI with a modal dialog box displayed at the end. The modal box is not displayed if the user cancels the installation. Use qb+! or qb!+ to hide the Cancel button.<br>qb- - Basic UI with no modal dialog boxes. Please note that /qb+- is not a supported UI level. Use qb-! or qb!- to hide the Cancel button.<br>Note that the ! option is available with Windows Installer 2.0 and works only with basic UI. It is not valid with full UI.                                                                                                                                                                                                                                                                                                                                                     |
| /? or /h |                                                                                     | Displays copyright information for Windows Installer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| /y       | module                                                                              | Calls the system function DllRegisterServer to self-register modules passed in on the command line. Specify the full path to the DLL. For example, for MY_FILE.DLL in the current folder you can use:<br>msiexec /y .\MY_FILE.DLL<br>This option is only used for registry information that cannot be added using the registry tables of the .msi file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| /z       | module                                                                              | Calls the system function DllUnRegisterServer to unregister modules passed in on the command line. Specify the full path to the DLL. For example, for MY_FILE.DLL in the current folder you can use:<br>msiexec /z .\MY_FILE.DLL<br>This option is only used for registry information that cannot be removed using the registry tables of the .msi file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| /c       |                                                                                     | Advertises a new instance of the product. Must be used in conjunction with /t. Available starting with the Windows Installer version that is shipped with Windows Server 2003 and Windows XP with Service Pack 1 (SP1).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| /n       | ProductCode                                                                         | Specifies a particular instance of the product. Used to identify an instance installed using the multiple instance support through a product code changing transforms. Available starting with the Windows Installer version shipped with Windows Server 2003 and Windows XP with SP1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## Standard Installer Command-Line Options

For more information see the [Microsoft Learn Documentation](https://learn.microsoft.com/en-us/windows/win32/msi/standard-installer-command-line-options)

| Option               | Parameters                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Example                                                                                                                                                                                                                                    |
|----------------------|----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /help                |                                  | Help and quick reference option.   Displays the correct usage of the msiexec command, including a list of all   switches and behavior. You can display the usage descriptions in the user   interface. Incorrect use of any other option invokes this help option.<br>     <br>     The equivalent Windows Installer command-line option is /?.                                                                                                                                                                                                                                                                              | msiexec /help.                                                                                                                                                                                                                             |
| /quiet               |                                  | Quiet display option. The   installer runs an installation without displaying a user interface. No   prompts, messages, or dialog boxes display to the user. The user can't cancel   the installation.<br>     <br>     Use the /norestart or /forcerestart standard command-line options to   control reboots. If no reboot option is specified, the installer restarts the   computer whenever necessary without displaying any prompt or warning to the   user.<br>     <br>     The equivalent Windows Installer command-line option is /qn.                                                                             | msiexec /package Application.msi   /quiet<br>     <br>     msiexec /uninstall Application.msi /quiet<br>     <br>     msiexec /update msipatch.msp /quiet<br>     <br>     msiexec /uninstall msipatch.msp /package Application.msi /quiet |
| /passive             |                                  | Passive display option. The   installer displays a progress bar to the user that indicates that an   installation is in progress, but displays no prompts or error messages to the   user. The user can't cancel the installation.<br>     <br>     Use the /norestart or /forcerestart standard command-line options to   control reboots. If no reboot option is specified, the installer restarts the   computer whenever necessary without displaying any prompt or warning to the   user.<br>     <br>     The equivalent Windows Installer command-line option is /qb!- with   REBOOTPROMPT=S set on the command line. | msiexec /package Application.msi /passive                                                                                                                                                                                                  |
| /norestart           |                                  | Never restart option. The   installer never restarts the computer after the installation.<br>     <br>     The equivalent Windows Installer command line has REBOOT=ReallySuppress set   on the command line.                                                                                                                                                                                                                                                                                                                                                                                                                | msiexec /package Application.msi /norestart                                                                                                                                                                                                |
| /forcerestart        |                                  | Always restart option. The   installer restarts the computer after every installation.<br>     <br>     The equivalent Windows Installer command line has REBOOT=Force set on the   command line.                                                                                                                                                                                                                                                                                                                                                                                                                            | msiexec /package Application.msi /forcerestart                                                                                                                                                                                             |
| /promptrestart       |                                  | Prompt before restarting option.   Displays a message that a restart is required to complete the installation   and asks the user whether to restart the system now. You can't use this   option with the /quiet option.<br>     <br>     The equivalent Windows Installer command line has REBOOTPROMPT =   "" set on the command line.                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                            |
| /uninstall (product) | <Package>.msi \|   <ProductCode> | Uninstall product option.   Uninstalls a product.<br>     <br>     The equivalent Windows Installer command-line option is /x.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                            |
| /uninstall   (patch) |                                  | Uninstall update option.   Uninstalls an update patch.<br>     <br>     The equivalent Windows Installer command-line option is /I with   MSIPATCHREMOVE=Update1.msp \| PatchGUID1[;Update2.msp \| PatchGUID2] set on the   command line.                                                                                                                                                                                                                                                                                                                                                                                    | msiexec /uninstall Update1.msp;PatchGUID2                                                                                                                                                                                                  |
| /log                 |                                  | Log option. Writes logging   information into a log file at the specified existing path. The path to the   log file location must already exist. The installer doesn't create the   directory structure for the log file.<br>     <br>     For more information about all the methods that are available for setting   the logging mode, see Normal logging for the Windows Installer.<br>     <br>     The equivalent Windows Installer command-line option is: /L*.                                                                                                                                                        |                                                                                                                                                                                                                                            |
| /package             | <Package>.msi \|   <ProductCode> | Install product option. Installs   or configures a product.<br>     <br>     The equivalent Windows Installer command-line option is /I.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                            |
| /update              | <Patch>.msp \| <PatchGUID>       | Install patches option. Installs   one or multiple patches.<br>     <br>     The equivalent Windows Installer command line has PATCH =   [<msipatch>.msp]<;PatchGuid> set on the command line.                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                            |

## Error Codes

These error codes are returned by the Windows Installer functions MsiExec.exe and InstMsi.exe. Note that any error in Winerror.h (such as ERROR_INVALID_DATA) can be returned as well.

| Error code                                 | Value | Description                                                                                                                                                                                                                                                                        |
|--------------------------------------------|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ERROR\_SUCCESS                             | 0     | The action completed successfully.                                                                                                                                                                                                                                                 |
| ERROR\_INVALID\_DATA                       | 13    | The data is invalid.                                                                                                                                                                                                                                                               |
| ERROR\_INVALID\_PARAMETER                  | 87    | One of the parameters was invalid.                                                                                                                                                                                                                                                 |
| ERROR\_CALL\_NOT\_IMPLEMENTED              | 120   | This value is returned when a custom action attempts to call a function that can't be called from custom actions. The function returns the value ERROR\_CALL\_NOT\_IMPLEMENTED.                                                                                                    |
| ERROR\_APPHELP\_BLOCK                      | 1259  | If Windows Installer determines a product might be incompatible with the current operating system, it displays a dialog box informing the user and asking whether to try to install anyway. This error code is returned if the user chooses not to try the installation.           |
| ERROR\_INSTALL\_SERVICE\_FAILURE           | 1601  | The Windows Installer service couldn't be accessed. Contact your support personnel to verify that the Windows Installer service is properly registered.                                                                                                                            |
| ERROR\_INSTALL\_USEREXIT                   | 1602  | The user canceled installation.                                                                                                                                                                                                                                                    |
| ERROR\_INSTALL\_FAILURE                    | 1603  | A fatal error occurred during installation.                                                                                                                                                                                                                                        |
| ERROR\_INSTALL\_SUSPEND                    | 1604  | Installation suspended, incomplete.                                                                                                                                                                                                                                                |
| ERROR\_UNKNOWN\_PRODUCT                    | 1605  | This action is only valid for products that are currently installed.                                                                                                                                                                                                               |
| ERROR\_UNKNOWN\_FEATURE                    | 1606  | The feature identifier isn't registered.                                                                                                                                                                                                                                           |
| ERROR\_UNKNOWN\_COMPONENT                  | 1607  | The component identifier isn't registered.                                                                                                                                                                                                                                         |
| ERROR\_UNKNOWN\_PROPERTY                   | 1608  | This is an unknown property.                                                                                                                                                                                                                                                       |
| ERROR\_INVALID\_HANDLE\_STATE              | 1609  | The handle is in an invalid state.                                                                                                                                                                                                                                                 |
| ERROR\_BAD\_CONFIGURATION                  | 1610  | The configuration data for this product is corrupt. Contact your support personnel.                                                                                                                                                                                                |
| ERROR\_INDEX\_ABSENT                       | 1611  | The component qualifier not present.                                                                                                                                                                                                                                               |
| ERROR\_INSTALL\_SOURCE\_ABSENT             | 1612  | The installation source for this product isn't available. Verify that the source exists and that you can access it.                                                                                                                                                                |
| ERROR\_INSTALL\_PACKAGE\_VERSION           | 1613  | This installation package can't be installed by the Windows Installer service. You must install a Windows service pack that contains a newer version of the Windows Installer service.                                                                                             |
| ERROR\_PRODUCT\_UNINSTALLED                | 1614  | The product is uninstalled.                                                                                                                                                                                                                                                        |
| ERROR\_BAD\_QUERY\_SYNTAX                  | 1615  | The SQL query syntax is invalid or unsupported.                                                                                                                                                                                                                                    |
| ERROR\_INVALID\_FIELD                      | 1616  | The record field does not exist.                                                                                                                                                                                                                                                   |
| ERROR\_INSTALL\_ALREADY\_RUNNING           | 1618  | Another installation is already in progress. Complete that installation before proceeding with this install. For information about the mutex, see [\_MSIExecute Mutex](-msiexecute-mutex.md).                                                                                      |
| ERROR\_INSTALL\_PACKAGE\_OPEN\_FAILED      | 1619  | This installation package couldn't be opened. Verify that the package exists and is accessible, or contact the application vendor to verify that this is a valid Windows Installer package.                                                                                        |
| ERROR\_INSTALL\_PACKAGE\_INVALID           | 1620  | This installation package couldn't be opened. Contact the application vendor to verify that this is a valid Windows Installer package.                                                                                                                                             |
| ERROR\_INSTALL\_UI\_FAILURE                | 1621  | There was an error starting the Windows Installer service user interface. Contact your support personnel.                                                                                                                                                                          |
| ERROR\_INSTALL\_LOG\_FAILURE               | 1622  | There was an error opening installation log file. Verify that the specified log file location exists and is writable.                                                                                                                                                              |
| ERROR\_INSTALL\_LANGUAGE\_UNSUPPORTED      | 1623  | This language of this installation package isn't supported by your system.                                                                                                                                                                                                         |
| ERROR\_INSTALL\_TRANSFORM\_FAILURE         | 1624  | There was an error applying transforms. Verify that the specified transform paths are valid.                                                                                                                                                                                       |
| ERROR\_INSTALL\_PACKAGE\_REJECTED          | 1625  | This installation is forbidden by system policy. Contact your system administrator.                                                                                                                                                                                                |
| ERROR\_FUNCTION\_NOT\_CALLED               | 1626  | The function couldn't be executed.                                                                                                                                                                                                                                                 |
| ERROR\_FUNCTION\_FAILED                    | 1627  | The function failed during execution.                                                                                                                                                                                                                                              |
| ERROR\_INVALID\_TABLE                      | 1628  | An invalid or unknown table was specified.                                                                                                                                                                                                                                         |
| ERROR\_DATATYPE\_MISMATCH                  | 1629  | The data supplied is the wrong type.                                                                                                                                                                                                                                               |
| ERROR\_UNSUPPORTED\_TYPE                   | 1630  | Data of this type isn't supported.                                                                                                                                                                                                                                                 |
| ERROR\_CREATE\_FAILED                      | 1631  | The Windows Installer service failed to start. Contact your support personnel.                                                                                                                                                                                                     |
| ERROR\_INSTALL\_TEMP\_UNWRITABLE           | 1632  | The Temp folder is either full or inaccessible. Verify that the *Temp* folder exists and that you can write to it.                                                                                                                                                                 |
| ERROR\_INSTALL\_PLATFORM\_UNSUPPORTED      | 1633  | This installation package isn't supported on this platform. Contact your application vendor.                                                                                                                                                                                       |
| ERROR\_INSTALL\_NOTUSED                    | 1634  | Component isn't used on this machine.                                                                                                                                                                                                                                              |
| ERROR\_PATCH\_PACKAGE\_OPEN\_FAILED        | 1635  | This patch package couldn't be opened. Verify that the patch package exists and is accessible, or contact the application vendor to verify that this is a valid Windows Installer patch package.                                                                                   |
| ERROR\_PATCH\_PACKAGE\_INVALID             | 1636  | This patch package couldn't be opened. Contact the application vendor to verify that this is a valid Windows Installer patch package.                                                                                                                                              |
| ERROR\_PATCH\_PACKAGE\_UNSUPPORTED         | 1637  | This patch package can't be processed by the Windows Installer service. You must install a Windows service pack that contains a newer version of the Windows Installer service.                                                                                                    |
| ERROR\_PRODUCT\_VERSION                    | 1638  | Another version of this product is already installed. Installation of this version can't continue. To configure or remove the existing version of this product, use **Add/Remove Programs** in **Control Panel**.                                                                  |
| ERROR\_INVALID\_COMMAND\_LINE              | 1639  | Invalid command line argument. Consult the Windows Installer SDK for detailed command-line help.                                                                                                                                                                                   |
| ERROR\_INSTALL\_REMOTE\_DISALLOWED         | 1640  | The current user isn't permitted to perform installations from a client session of a server running the Terminal Server role service.                                                                                                                                              |
| ERROR\_SUCCESS\_REBOOT\_INITIATED          | 1641  | The installer has initiated a restart. This message indicates success.                                                                                                                                                                                                             |
| ERROR\_PATCH\_TARGET\_NOT\_FOUND           | 1642  | The installer can't install the upgrade patch because the program being upgraded may be missing or the upgrade patch updates a different version of the program. Verify that the program to be upgraded exists on your computer and that you have the correct upgrade patch.       |
| ERROR\_PATCH\_PACKAGE\_REJECTED            | 1643  | The patch package isn't permitted by system policy.                                                                                                                                                                                                                                |
| ERROR\_INSTALL\_TRANSFORM\_REJECTED        | 1644  | One or more customizations aren't permitted by system policy.                                                                                                                                                                                                                      |
| ERROR\_INSTALL\_REMOTE\_PROHIBITED         | 1645  | Windows Installer doesn't permit installation from a Remote Desktop Connection.                                                                                                                                                                                                    |
| ERROR\_PATCH\_REMOVAL\_UNSUPPORTED         | 1646  | The patch package isn't a removable patch package.                                                                                                                                                                                                                                 |
| ERROR\_UNKNOWN\_PATCH                      | 1647  | The patch isn't applied to this product.                                                                                                                                                                                                                                           |
| ERROR\_PATCH\_NO\_SEQUENCE                 | 1648  | No valid sequence could be found for the set of patches.                                                                                                                                                                                                                           |
| ERROR\_PATCH\_REMOVAL\_DISALLOWED          | 1649  | Patch removal was disallowed by policy.                                                                                                                                                                                                                                            |
| ERROR\_INVALID\_PATCH\_XML                 | 1650  | The XML patch data is invalid.                                                                                                                                                                                                                                                     |
| ERROR\_PATCH\_MANAGED\_ADVERTISED\_PRODUCT | 1651  | Administrative user failed to apply patch for a per-user managed or a per-machine application that'is in advertised state.                                                                                                                                                         |
| ERROR\_INSTALL\_SERVICE\_SAFEBOOT          | 1652  | Windows Installer isn't accessible when the computer is in *Safe Mode*. Exit Safe Mode and try again or try using [system restore](/windows/desktop/sr/system-restore-portal) to return your computer to a previous state. Available beginning with Windows Installer version 4.0. |
| ERROR\_ROLLBACK\_DISABLED                  | 1653  | Couldn't perform a multiple-package transaction because rollback has been disabled. [Multiple-package installations](multiple-package-installations.md) can't run if rollback is disabled. Available beginning with Windows Installer version 4.5.                                 |
| ERROR\_INSTALL\_REJECTED                   | 1654  | The app that you're trying to run isn't supported on this version of Windows. A Windows Installer package, patch, or transform that has not been signed by Microsoft can't be installed on an ARM computer.                                                                        |
| ERROR\_SUCCESS\_REBOOT\_REQUIRED           | 3010  | A restart is required to complete the install. This message indicates success. This does not include installs where the [ForceReboot](forcereboot-action.md) action is run.                                                                                                        |
